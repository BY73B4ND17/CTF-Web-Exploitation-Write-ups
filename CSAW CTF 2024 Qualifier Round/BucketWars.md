BucketWars

Challenge Description : let's keep our storage simple -- and remember we don't make mistakes in these parts.

- Enumeration

The name of the challenge suggests that it might have something to do with AWS S3 Buckets.

On examining the website, we find the tab for "Versions", wherein 5 versions (V1-V5) are listed.
On clicking the "V1", we get this page. (Seems fishy)

![VERSION V1 PAGE](/Images/162119.png)

The main page (V5) reads "Looking deeper into the stolen bucket only reveals past versions of our own selves one might muse" 
This is a vital clue, that we might have to check previous versions of particular endpoints. 


- Exploitation

Let's use the AWSCli tool on our Kali Linux to solve this. If you don't have the tool, you can download it using the command : 
'sudo apt install awscli'

First, let's list all the versions available using this command : 
`aws s3api list-object-versions --bucket bucketwars.ctf.csaw.io --no-sign-request`

On scrolling down, we get multiple older versions of the /index_v1.html (The "YIKES") endpoint. So, I tried downloading the HTML source code for the two oldest versions with IDs `t6G6A20JCaF5nzz6KuJR6Pj1zePOLAdB` and `CFNz2JPIIJfRlNfnVx8a45jgh0J90KxS` respectively. 

The command I used for this is :
`aws s3api get-object --bucket bucketwars.ctf.csaw.io --key "index_v1.html" --version-id "The Particular ID" indexv1 --no-sign-request`

On viewing both these source codes, we find a password in one code and a link to an image in the other. 

Here, we have to download the image and perform a simple Steghide on it using the password. Here's the command :
`steghide extract -sf sand-pit-1345726_640.jpg -p versions_leaks_buckets_oh_my`

Finally, read the flag from the text file.

`FLAG : csawctf{lEaKY_Bu4K3tz_oH_m3_04_mY!}`
